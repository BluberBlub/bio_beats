---
export const prerender = true;
import BaseLayout from "../../../layouts/BaseLayout.astro";
import {
    ArrowRight,
    CheckCircle,
    Music,
    Sparkles,
    Palette,
    Briefcase,
    Disc3,
    Calendar,
    Settings,
    Heart,
} from "lucide-react";
import { roleOptions } from "../../../data/navigation";
import { languages } from "../../../i18n";
import { getTranslations } from "../../../i18n";

export function getStaticPaths() {
    return Object.keys(languages).map((lang) => ({ params: { lang } }));
}

const { lang } = Astro.params;
const t = getTranslations(lang as keyof typeof languages);
const tj = t.join;

// Page Meta
const pageTitle = tj.title;
const pageDescription = tj.subtitle;

const iconComponents: Record<string, any> = {
    Music,
    Sparkles,
    Palette,
    Briefcase,
    Disc3,
    Calendar,
    Settings,
    Heart,
};

// Map role labels using translations
// We cast to any to avoid strict key checking issues if types aren't perfectly aligned yet
const roleLabelMap: Record<string, string> = {
    artist: t.admin.roles.artist,
    performer: t.admin.roles.performer,
    creative: t.admin.roles.creative,
    manager: t.admin.roles.manager,
    label: t.admin.roles.label,
    booker: t.admin.roles.booker,
    provider: t.admin.roles.provider,
    guest: t.admin.roles.guest,
};

// Use type assertion to avoid strict key checking if necessary
// t.join.benefits is indexed by the specific keys in the type definition
const roleDescriptions: Record<string, string> = {
    artist: (t.join.benefits as any).artist?.[0] || "",
    performer: (t.join.benefits as any).performer?.[0] || "",
    creative: (t.join.benefits as any).creative?.[0] || "",
    manager: (t.join.benefits as any).manager?.[0] || "",
    label: (t.join.benefits as any).label?.[0] || "",
    booker: (t.join.benefits as any).booker?.[0] || "",
    provider: (t.join.benefits as any).provider?.[0] || "",
    guest: (t.join.benefits as any).guest?.[0] || "",
};
---

<BaseLayout title={pageTitle} description={pageDescription} lang={lang}>
    <section class="py-16 bg-gradient-to-b from-bio-gray-900 to-bio-black">
        <div class="container-narrow text-center">
            <h1 class="text-bio-white mb-4">{tj.title}</h1>
            <p class="text-xl text-bio-gray-400">
                {tj.subtitle}
            </p>
        </div>
    </section>

    <section class="section bg-bio-black">
        <div class="container-wide">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                {
                    roleOptions.map((role) => {
                        const IconComponent = iconComponents[role.icon];
                        return (
                            <a
                                href={`/${lang === "de" ? "de" : "en"}/join/${role.id}`}
                                class="card-hover p-6 group text-center"
                            >
                                <div class="w-16 h-16 mx-auto rounded-full bg-bio-gray-800 flex items-center justify-center mb-4 group-hover:bg-bio-accent/20 transition-colors">
                                    <IconComponent className="w-8 h-8 text-bio-gray-400 group-hover:text-bio-accent transition-colors" />
                                </div>
                                <h3 class="text-lg font-semibold text-bio-white group-hover:text-bio-accent transition-colors mb-2">
                                    {roleLabelMap[role.id] || role.label}
                                </h3>
                                <p class="text-sm text-bio-gray-400 line-clamp-2">
                                    {roleDescriptions[role.id] ||
                                        role.description}
                                </p>
                            </a>
                        );
                    })
                }
            </div>

            <div class="mt-12 text-center">
                <p class="text-bio-gray-400 mb-4">
                    {tj.alreadyHaveAccount}{" "}
                    <a
                        href={`/${lang === "de" ? "de" : "en"}/login`}
                        class="text-bio-accent hover:underline"
                        >{tj.loginHere}</a
                    >
                </p>
            </div>
        </div>
    </section>
</BaseLayout>
