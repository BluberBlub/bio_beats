
# TEST MODE: RULES RESTORED (Safe Mode)
# Options -Indexes <-- THIS WAS THE CAUSE OF 500 ERROR

DirectoryIndex index.html
ErrorDocument 404 /404.html

<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteBase /
  
  # 0. KEY FIX (v2 Safe Mode): 
  # If request starts with /client/, Stop rewriting and serve file.
  # This prevents loops and 500 errors on shared hosts.
  RewriteRule ^client/ - [L]
  
  # 1. Assets & System Files (Legacy support for /_astro/ requests)
  RewriteRule ^_astro/(.*)$ /client/_astro/$1 [L]
  RewriteRule ^fonts/(.*)$ /client/fonts/$1 [L]
  RewriteRule ^assets/(.*)$ /client/assets/$1 [L]
  RewriteRule ^artists/(.*)\.png$ /client/artists/$1.png [L]
  RewriteRule ^uploads/(.*)$ /client/uploads/$1 [L]
  RewriteRule ^site\.webmanifest$ /client/site.webmanifest [L]
  RewriteRule ^sitemap(.*)\.xml$ /client/sitemap$1.xml [L]
  RewriteRule ^robots\.txt$ /client/robots.txt [L]
  
  # Specific root files if missing
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteRule ^logo\.svg$ /client/logo.svg [L]
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteRule ^favicon\.(svg|ico)$ /client/favicon.$1 [L]

  # 2. Page Routing (Simplified - No File Checks)
  
  # Standard pages (extensionless) -> /client/page/index.html
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteRule ^([^.]+)$ /client/$1/index.html [L]

  # Homepage fallback (if not handled by DirectoryIndex)
  RewriteRule ^$ /index.html [L]
</IfModule>
